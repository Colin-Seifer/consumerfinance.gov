{% extends 'content-base.html' %}
{% from 'organisms/expandable.html' import expandable with context %}

{% block title -%}
    Survey Results | Consumer Financial Protection Bureau
{%- endblock %}

{% block css -%}
    {{ super() }}

    <link rel="stylesheet" href="{{ static('apps/teachers-digital-platform/css/main.css') }}">
{%- endblock css %}

{% block pre_content scoped -%}
{%- endblock %}

{% block body_content scoped %}
    <div class="content_wrapper tdp-assessment-results">
        {% set level = content.find_level(score) %}
        {% set bbs = content.building_blocks() %}

        {% if is_student %}
        <h1>Congrats!</h1>
        {% else %}
        <h1>Results
            <span hidden class="show-initials">for <strong></strong></span>
        </h1>
        {% endif %}

        <p>Adjusted score: {{ score }} <b>{{ level.title }}</b></p>

        <h2>Viewing Assessment: {{ assessment.meta.name }}</h2>
        {% for subtotal in subtotals %}
        {% set area = content.find_area(loop.index0, subtotal) %}
            <h3>{{ bbs[loop.index0].title }}</h3>
            <p>{{ bbs[loop.index0].intro }}</p>
            <p>{{ subtotal }} -> <b>{{ area.title }}</b>: {{ area.desc }}</p>
        {% endfor %}

        {% if is_student %}
        <h2>Share URL</h2>
        <form class="share-url-form">
            <div class="share-customize">
                <input class="a-text-input"
                   type="text"
                   name="initials"
                   placeholder="Enter your initials"
                   required minlength="2" maxlength="4" autocomplete="off">
                <button class="a-btn">Create URL</button>
            </div>
            <div class="share-output" hidden>
                <input readonly type="text" onclick="this.select()" value=""
                       class="shared-url a-text-input a-text-input__full" data-rparam="{{ r_param }}">
            </div>
        </form>

        <p>
            <a class="a-btn a-btn__warning results-start-over" href="../intro/">
             Start Over
            </a>
        </p>
        {% endif %}
    </div>
{% endblock body_content %}

{% block javascript %}
    {{ super() }}

    {# Conditional comment used to block IE8 and under from receiving JS #}
    <!--[if gt IE 8]><!-->
        <script src="{{ static('apps/teachers-digital-platform/js/index.js') }}"></script>
    <!--<![endif]-->
{% endblock javascript %}
